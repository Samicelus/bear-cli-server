var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function a(t){try{c(i.next(t))}catch(e){o(e)}}function s(t){try{c(i["throw"](t))}catch(e){o(e)}}function c(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(a,s)}c((i=i.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return i([t,e])}}function i(n){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=e.call(t,c)}catch(i){n=[6,i],o=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},Catalog;!function(t){var e=function(t){function e(e,n){var i=t.call(this)||this;return i.dataList=n,i.addEventListener(eui.UIEvent.COMPLETE,i.uiCompHandler,i),i.bear_cli=e,i.skinName="skins.catalogPadSkin",i}return __extends(e,t),e.prototype.uiCompHandler=function(){var t=this;this.dataList.forEach(function(e){e.bear_cli=t.bear_cli})},e.prototype.createChildren=function(){var e=this;t.prototype.createChildren.call(this),egret.Tween.get(this.catalogBackground).to({height:520},1e3).call(function(){e.ListCatalogs.dataProvider=new eui.ArrayCollection(e.dataList),e.ListCatalogs.itemRenderer=n},this)},e}(eui.Component);t.CatalogPad=e,__reflect(e.prototype,"Catalog.CatalogPad");var n=function(t){function e(){var e=t.call(this)||this;return e.skinName="skins.catalogSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.icon.mask=this.mask,this.icon.addEventListener(egret.TouchEvent.TOUCH_TAP,this.select,this)},e.prototype.dataChanged=function(){this.bear_cli=this.data.bear_cli},e.prototype.select=function(t){var e=this.data._id,n={catalog_id:e,battle_type:"solo"};this.bear_cli.request("question.question_handler.soloBattle",n)},e}(eui.ItemRenderer);__reflect(n.prototype,"Catalog")}(Catalog||(Catalog={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function i(i){e.call(n,i,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?i(r):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e,n;return __generator(this,function(i){switch(i.label){case 0:return t="samicelus.cc",e=3030,this.ajax=new Bear_cli.Http,this.bear_cli=new Bear_cli.Bear_cli(t,e),this.bear_handlers=new Bear_handlers.Bear_handlers(this.bear_cli,this),this.bear_cli.handlers=this.bear_handlers,[4,this.loadResource()];case 1:return i.sent(),this.createGameScene(),[4,platform.login()];case 2:return i.sent(),[4,platform.getUserInfo()];case 3:return n=i.sent(),console.log(n),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,this.loadTheme()];case 2:return n.sent(),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadGroup("preload",0,t)];case 3:return n.sent(),this.stage.removeChild(t),[3,5];case 4:return e=n.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,n){var i=new eui.Theme("resource/default.thm.json",t.stage);i.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){var t=this.stage.stageWidth,e=this.stage.stageHeight,n=new egret.Shape;n.graphics.beginFill(0),n.graphics.drawRect(0,0,t,e),n.graphics.endFill(),this.addChild(n),this._characterPad=new Character.CharacterPad(this.bear_cli,[]),this._characterPad.horizontalCenter=0,this._characterPad.y=20,this.addChild(this._characterPad);var i={text:"",leftTitle:"",rightTitle:""};i.text="这里是超级英熊的集结地，他们正默默地守护着这个世界。（中二甘东）这个世界上人类中的一小部分存在基因变异，这部分人就被称为超能力者，他们大多数拥超越普通人的特殊能力，做出一些不同寻常的壮举和英勇的行为，保护人民，与恶势力搏斗。虽然他们都各有特点，但是多数的超级英熊都有以下的特征：拥有非凡的力量和相关的技术能力，精通相关的设备。虽然超级英熊们都有着非常强大的力量，但是这些力量却不尽相同。他们希望主持正义，在有危险时挺身而出，富有责任感，并且不需要任何回报",i.leftTitle="旁白",this._dialogPad=new Dialog.DialogPad(this.bear_cli,i,this),this._dialogPad.horizontalCenter=0,this._dialogPad.y=850,this.addChild(this._dialogPad)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},e.prototype.nextContent=function(){var t={text:"",leftTitle:"",rightTitle:""};t.text="是么？\n那我们可以要拭目以待了哦。",t.leftTitle="吃瓜群众",this._dialogPad.setText(t)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,i){function r(t){e.call(i,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(i))}"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(i,generateEUI)},this):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Bear_cli;!function(t){var e=function(){function t(t,e){this._ajax=new n,this._host=t;var i=io.connect("http://"+t,{path:"/"+e+"/socket.io/"});this._socket=i;var r=this;this._socket.on("message",function(t){console.log("\n[user socket] recieve data:",t);var e=t.handler_name+"_handler";r._handlers&&r._handlers[e]&&r._handlers[e](t)}),this._app_socket={},this._token="",this._handlers={},this._expire=0}return t.prototype.reset_expire=function(){this._expire=0},Object.defineProperty(t.prototype,"login_name",{set:function(t){this._login_name=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pwd",{set:function(t){this._pwd=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"user_id",{get:function(){return this._user_id},set:function(t){this._user_id=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"token",{set:function(t){this._token=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"expire",{set:function(t){this._expire=t-6e4},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"handlers",{set:function(t){this._handlers=t},enumerable:!0,configurable:!0}),t.prototype.relog=function(){return __awaiter(this,void 0,void 0,function(){var t,e,n,i;return __generator(this,function(r){return t=this,e="http://"+this._host,n=this.login_name,i=this.pwd,[2,this._ajax.post({login:n,pwd:i},e+"/question/loginFront",{"Content-Type":"application/x-www-form-urlencoded"}).then(function(e){if(console.log("log_ret:",e),"TRUE"==e.result){e.data&&(t.token=e.data.token,t.expire=e.data.expire_timestamp);var n="user.user_handler.login";return t.request(n,{})}return!1})["catch"](function(t){throw t})]})})},t.prototype.login=function(t,e){return __awaiter(this,void 0,void 0,function(){var n,i;return __generator(this,function(r){return console.log("login with:"+t+","+e),n=this,i="http://"+this._host,[2,this._ajax.post({login:t,pwd:e},i+"/question/loginFront",{"Content-Type":"application/x-www-form-urlencoded"}).then(function(i){if(console.log("log_ret:",i),"TRUE"==i.result){i.data&&(n.user_id=i.data.user_id,n.token=i.data.token,n.expire=i.data.expire_timestamp,n.login_name=t,n.pwd=e);var r="user.user_handler.login";return n.request(r,{})}return!1})["catch"](function(t){throw t})]})})},t.prototype.regist=function(t,e,n){return __awaiter(this,void 0,void 0,function(){var i,r;return __generator(this,function(o){return console.log("regist with:"+t+","+e+","+n),i=this,r="http://"+this._host,[2,this._ajax.post({login:t,pwd:e,code:n},r+"/question/registFront",{"Content-Type":"application/x-www-form-urlencoded"}).then(function(n){if(console.log("log_ret:",n),"TRUE"==n.result){n.data&&(i.user_id=n.data.user_id,i.token=n.data.token,i.expire=n.data.expire_timestamp,i.login_name=t,i.pwd=e);var r="user.user_handler.login";return i.request(r,{})}return console.log(n),!1})["catch"](function(t){throw t})]})})},t.prototype.sendCheckPhone=function(t){return __awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(i){return console.log("sendCheck with:"+t),e=this,n="http://"+this._host,[2,this._ajax.post({login:t},n+"/question/sendCheckPhone",{"Content-Type":"application/x-www-form-urlencoded"}).then(function(t){return console.log("log_ret:",t),"TRUE"==t.result?(console.log("发送成功"),!0):(console.log(t),!1)})["catch"](function(t){throw t})]})})},t.prototype.http_request=function(t,e,n){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(r){return i="http://"+this._host,"post"==e.toLowerCase()?[2,this._ajax.post(n,i+t,{"Content-Type":"application/x-www-form-urlencoded"})]:"get"==e.toLowerCase()?[2,this._ajax.get(n,i+t,{"Content-Type":"application/x-www-form-urlencoded"})]:[2]})})},t.prototype.request=function(t,e){return __awaiter(this,void 0,void 0,function(){var n,i,r,o,a,s;return __generator(this,function(c){return n=this,i=(new Date).getTime(),this._expire<i?[2,this.relog().then(function(i){if(i){console.log("request:"+t);var r=t.split(".")[0];console.log("server_type:"+r);var o="user"==r?n._socket:n._app_socket[r],a=t.split(".")[1],s=t.split(".")[2];return e.user_id=n._user_id,e.token=n._token,e.handler_name=a,e.method=s,Promise.resolve(o.send(e))}})["catch"](function(t){throw t})]:(console.log("request:"+t),r=t.split(".")[0],console.log("server_type:"+r),o="user"==r?this._socket:this._app_socket[r],a=t.split(".")[1],s=t.split(".")[2],e.user_id=this._user_id,e.token=this._token,e.handler_name=a,e.method=s,[2,Promise.resolve(o.send(e))])})})},t.prototype.set_app_socket=function(t,e,n){this._app_socket[t]=io.connect("http://"+e,{path:"/"+n+"/socket.io/"});var i=this;this._app_socket[t].on("message",function(e){console.log("\n["+t+" socket] recieve data:",e);var n=e.handler_name+"_handler";i._handlers&&i._handlers[n]&&i._handlers[n](e)})},t}();t.Bear_cli=e,__reflect(e.prototype,"Bear_cli.Bear_cli");var n=function(){function t(){this._xhr=new egret.HttpRequest}return t.prototype.get=function(t,e,n){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(r){return i=this,i._xhr.responseType=egret.HttpResponseType.TEXT,[2,new Promise(function(r,o){var a=[];for(var s in t)a.push(s+"="+t[s]);var c=a.join("&");if(-1!=e.indexOf("?")?e+=c:c&&(e+="?"+c),i._xhr.open(e,egret.HttpMethod.GET),n)for(var h in n)i._xhr.setRequestHeader(h,n[h]);i._xhr.send(),i._xhr.addEventListener(egret.Event.COMPLETE,function(t){try{var e=void 0;try{e=JSON.parse(i._xhr.response)}catch(n){e=i._xhr.response}r(e)}catch(n){o(n)}},this),i._xhr.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){o(t)},this)})]})})},t.prototype.post=function(t,e,n){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(r){return i=this,[2,new Promise(function(r,o){var a=[];for(var s in t)a.push(s+"="+t[s]);var c=a.join("&");if(i._xhr.open(e,egret.HttpMethod.POST),n)for(var h in n)i._xhr.setRequestHeader(h,n[h]);i._xhr.send(c),i._xhr.addEventListener(egret.Event.COMPLETE,function(t){try{var e=void 0;try{e=JSON.parse(i._xhr.response)}catch(n){e=i._xhr.response}r(e)}catch(n){o(n)}},this),i._xhr.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){o(t)},this)})]})})},t}();t.Http=n,__reflect(n.prototype,"Bear_cli.Http")}(Bear_cli||(Bear_cli={}));var Bear_handlers;!function(t){var e=function(){function t(t,e){this.client=t,this.mainScene=e}return t.prototype.return_handler=function(t){if(t.result){if(t.data&&t.data.route_map){var e=t.data.route_map;for(var n in e)this.client.set_app_socket(n,e[n].host,e[n].port);this.mainScene.handler_logged()}if(t.method_name)switch(t.method_name){case"":}}},t.prototype.startBattle_handler=function(t){this.mainScene.handler_battle(t.battle_info)},t.prototype.showChoices_handler=function(t){this.mainScene.handler_changeState("showChoices",t.battle_id)},t.prototype.chooseAnswer_handler=function(t){this.mainScene.handler_changeState("chooseAnswer",t.answer_id)},t.prototype.showResult_handler=function(t){this.mainScene.handler_changeState("showResult",t.result)},t.prototype.nextQuestion_handler=function(t){this.mainScene.handler_nextQuestion(t.current_index)},t.prototype.battleEnd_handler=function(t){this.mainScene.handler_endBattle(t.player_info)},t}();t.Bear_handlers=e,__reflect(e.prototype,"Bear_handlers.Bear_handlers")}(Bear_handlers||(Bear_handlers={}));var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.loadingPad=new Loading.LoadingPad,this.addChild(this.loadingPad)},e.prototype.onProgress=function(t,e){this.loadingPad&&this.loadingPad.setProgressData(t,e)},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Character;!function(t){var e=function(t){function e(e,n){var i=t.call(this)||this;return i.dataList=n,i.addEventListener(eui.UIEvent.COMPLETE,i.uiCompHandler,i),i.bear_cli=e,i.skinName="skins.characterPadSkin",i}return __extends(e,t),e.prototype.uiCompHandler=function(){var t=this;this.dataList.forEach(function(e){e.bear_cli=t.bear_cli})},e.prototype.createChildren=function(){var e=this;t.prototype.createChildren.call(this),egret.Tween.get(this.characterBackground).to({width:600},1e3).to({height:800},1e3).call(function(){egret.Tween.get(e.waterMark).to({alpha:.3},1e3,egret.Ease.sineOut),egret.Tween.get(e.characterBorder).to({alpha:1},1e3,egret.Ease.sineOut).call(function(){egret.Tween.get(e.character).to({alpha:1},100).to({alpha:0},100).to({alpha:1},100).to({alpha:0},100).to({alpha:1},600)})},this)},e}(eui.Component);t.CharacterPad=e,__reflect(e.prototype,"Character.CharacterPad")}(Character||(Character={}));var Dialog;!function(t){var e=function(t){function e(e,n,i){var r=t.call(this)||this;return r.data=n,r.contentQueue=[],r.finishLoading=!0,r.seperateText(n.text.split("")),r.addEventListener(eui.UIEvent.COMPLETE,r.uiCompHandler,r),r.bear_cli=e,r.mainScene=i,r.skinName="skins.dialogPanelSkin",r}return __extends(e,t),e.prototype.uiCompHandler=function(){var t=this;this.showTextArr=[],this.data.leftTitle&&(this.leftTitle.text=this.data.leftTitle.length>6?this.data.leftTitle.slice(0,6):this.data.leftTitle),this.data.rightTitle&&(this.rightTitle.text=this.data.rightTitle.length>6?this.data.rightTitle.slice(0,6):this.data.rightTitle),this.next.source="",this.contentQueue[0]&&(this.finishLoading=!1,this.printerTimer=setInterval(function(){t.contentQueue[0]&&t.contentQueue[0].length?(t.showTextArr.push(t.contentQueue[0].shift()),t.renewLabel()):(t.finishLoading=!0,t.next.source="resource/customer_ui/dialog/next.png",egret.Tween.get(t.next,{loop:!0}).to({y:t.original_next_y+15},300,egret.Ease.sineIn).to({y:t.original_next_y},300,egret.Ease.sineOut),clearInterval(t.printerTimer))},50))},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.Tween.get(this.border).to({width:600},300,egret.Ease.sineIn).to({height:230},400,egret.Ease.sineOut),this.original_next_y=this.next.y,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextText,this)},e.prototype.renewLabel=function(){var t=this.showTextArr.join("");this.dialogText&&(this.dialogText.text=t,this.dialogText.size=30)},e.prototype.setText=function(t){this.data=t,this.finishLoading=!0,this.contentQueue=[],this.seperateText(t.text.split("")),this.uiCompHandler()},e.prototype.nextText=function(){this.finishLoading&&(this.contentQueue.length>1?(this.contentQueue.shift(),this.uiCompHandler()):this.mainScene.nextContent())},e.prototype.seperateText=function(t){if(t.length>90){var e=t.slice(0,90),n=t.slice(90);this.contentQueue.push(e),this.seperateText(n)}else this.contentQueue.push(t)},e}(eui.Component);t.DialogPad=e,__reflect(e.prototype,"Dialog.DialogPad")}(Dialog||(Dialog={}));var Final;!function(t){var e=function(t){function e(e,n,i){var r=t.call(this)||this;return r.data=n,r.addEventListener(eui.UIEvent.COMPLETE,r.uiCompHandler,r),r.bear_cli=e,r.mainScene=i,r.skinName="skins.finalPadSkin",r}return __extends(e,t),e.prototype.uiCompHandler=function(){console.log("add player info...");var t=[],e=this.data[this.bear_cli.user_id];e.bear_cli=this.bear_cli,console.log("player_info:",e),t.push(e),this.player_info_collection=new eui.ArrayCollection(t),this.playerInfo.dataProvider=this.player_info_collection,this.playerInfo.itemRenderer=n},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.backButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backToList,this)},e.prototype.backToList=function(){this.mainScene.backToList()},e}(eui.Component);t.FinalPad=e,__reflect(e.prototype,"Final.FinalPad");var n=function(t){function e(){var e=t.call(this)||this;return e.skinName="skins.playerFinalSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.icon.mask=this.mask},e.prototype.dataChanged=function(){this.bear_cli||(this.bear_cli=this.data.bear_cli),this.score&&(this.score.text=this.data.scores,egret.Tween.get(this.score).to({size:80},100,egret.Ease.sineIn).to({size:44},300,egret.Ease.sineOut))},e}(eui.ItemRenderer);__reflect(n.prototype,"FinalPlayer")}(Final||(Final={}));var Loading;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="skins.loadingPanelSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.setProgressData=function(t,e){this.pb.value=t,this.pb.maximum=e},e}(eui.Component);t.LoadingPad=e,__reflect(e.prototype,"Loading.LoadingPad")}(Loading||(Loading={}));var Login;!function(t){var e=function(t){function e(e){var n=t.call(this)||this;return n.bear_cli=e,n.skinName="skins.CustomerPanelSkin",n}return __extends(e,t),e.prototype.partAdded=function(e,n){t.prototype.partAdded.call(this,e,n)},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.login_input.addEventListener(egret.FocusEvent.FOCUS_IN,this.login_focus_in,this),this.pwd_input.addEventListener(egret.FocusEvent.FOCUS_IN,this.pwd_focus_in,this),this.login_input.addEventListener(egret.FocusEvent.FOCUS_OUT,this.login_focus_out,this),this.pwd_input.addEventListener(egret.FocusEvent.FOCUS_OUT,this.pwd_focus_out,this),this.loginButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.login,this),this.registButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.regist,this),this.sendCheckButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendCheck,this)},e.prototype.login=function(){this.bear_cli.login(this.login_input.text,this.pwd_input.text).then(function(t){console.log("request result:",t)})["catch"](function(t){console.error(t)})},e.prototype.regist=function(){this.login_input.text,this.pwd_input.text;this.bear_cli.regist(this.login_input.text,this.pwd_input.text,this.code_input.text).then(function(t){console.log("request result:",t)})["catch"](function(t){console.error(t)})},e.prototype.sendCheck=function(){var t=this;this.bear_cli.sendCheckPhone(this.login_input.text).then(function(e){1==e&&(t.sendCheckButton.currentState="disabled")})["catch"](function(t){console.error(t)})},e.prototype.login_focus_in=function(){this.login_input.currentState="focused"},e.prototype.pwd_focus_in=function(){this.pwd_input.currentState="focused"},e.prototype.login_focus_out=function(){this.login_input.currentState="normal"},e.prototype.pwd_focus_out=function(){this.pwd_input.currentState="normal"},e}(eui.Component);t.LoginPad=e,__reflect(e.prototype,"Login.LoginPad")}(Login||(Login={}));var Question;!function(t){var e=function(t){function e(e,n){var i=t.call(this)||this;return i.user_id=e.user_id,i.battle_info=n,i.current_index=0,i.score=0,i.result=!1,i.bear_cli=e,i.skinName="skins.questionPadSkin",i}return __extends(e,t),e.prototype.uiCompHandler=function(){console.log("add player info...");var t=[],e=this.battle_info.players[this.user_id];e.bear_cli=this.bear_cli,e.score=this.score,t.push(e),this.player_info_collection=new eui.ArrayCollection(t),this.playerInfo.dataProvider=this.player_info_collection,this.playerInfo.itemRenderer=n,console.log("add timer info...");var o=[],a={state:"normal",second:10};o.push(a),this.timer_info_collection=new eui.ArrayCollection(o),this.timer.dataProvider=this.timer_info_collection,this.timer.itemRenderer=i,console.log("add question info...");var s=[],c=this.battle_info.questions[this.current_index];c.bear_cli=this.bear_cli,c.battle_id=this.battle_info.id,c.current_index=this.current_index,c.current_state="showTitle",c.answered=!1,s.push(c),this.question_info_collection=new eui.ArrayCollection(s),this.question.dataProvider=this.question_info_collection,this.question.itemRenderer=r;var h={battle_id:this.battle_info.id};this.bear_cli.request("question.question_handler.ready",h)},e.prototype.createChildren=function(){var e=this;t.prototype.createChildren.call(this),egret.Tween.get(this.questionBackground).to({height:800},1e3).call(function(){e.uiCompHandler()},this)},e.prototype.changeTimerState=function(t,e){var n=this;switch(this.timer_info_collection.source[0].state=t,t){case"showChoices":this.timer_info_collection.source[0].second=10,this.timer_info_collection.refresh(),this.question_info_collection.source[0].current_state="showChoices",this.question_info_collection.refresh(),clearInterval(this.timer_count),this.timer_count=setInterval(function(){n.timer_info_collection.source[0].second>0?(n.timer_info_collection.source[0].second-=1,n.timer_info_collection.refresh()):clearInterval(n.timer_count)},1e3);break;case"chooseAnswer":;break;case"showResult":if(!this.result){this.timer_info_collection.source[0].second=0,this.timer_info_collection.refresh(),this.question_info_collection.source[0].current_state="showResult",this.question_info_collection.refresh(),clearInterval(this.timer_count);var i=e;for(var r in i)r==this.user_id&&i[r].result&&(this.score+=i[r].addedScore,this.player_info_collection.source[0].score=this.score,this.player_info_collection.refresh());this.result=!0}}},e.prototype.toNextQuestion=function(t){this.result=!1,clearInterval(this.timer_count),this.current_index=t,this.uiCompHandler()},e}(eui.Component);t.QuestionPad=e,__reflect(e.prototype,"Question.QuestionPad");var n=function(t){function e(){var e=t.call(this)||this;return e.skinName="skins.playerSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.icon.mask=this.mask},e.prototype.dataChanged=function(){this.bear_cli||(this.bear_cli=this.data.bear_cli),this.score&&(this.score.text="得分:"+this.data.score,egret.Tween.get(this.score).to({size:28},100,egret.Ease.sineIn).to({size:18},300,egret.Ease.sineOut))},e}(eui.ItemRenderer);__reflect(n.prototype,"Player");var i=function(t){function e(){var e=t.call(this)||this;return e.skinName="skins.timerSkin",e}return __extends(e,t),e.prototype.createChildren=function(){var e=this;t.prototype.createChildren.call(this),this.addEventListener(egret.Event.ENTER_FRAME,function(t){e.circle_outter&&(e.circle_outter.rotation+=1),e.circle_inner&&(e.circle_inner.rotation-=2)},this)},e.prototype.dataChanged=function(){this.timer_second&&(this.timer_second.text=this.data.second,Number(this.data.second)<4?this.currentState="alert":this.currentState="normal")},e}(eui.ItemRenderer);__reflect(i.prototype,"Timer");var r=function(t){function e(){var e=t.call(this)||this;return e.skinName="skins.questionSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){this.bear_cli||(this.bear_cli=this.data.bear_cli),this.battle_id||(this.battle_id=this.data.battle_id),this.current_index=this.data.current_index,"showChoices"==this.data.current_state&&this.uiCompHandler(),"showResult"==this.data.current_state&&(this.choice_info_collection.source.forEach(function(t){t.isCorrect?t.current_state="right":t.selected&&(t.current_state="wrong")}),this.choice_info_collection.refresh())},e.prototype.uiCompHandler=function(){var t=this,e=this.data.options;e.forEach(function(e){e.bear_cli=t.data.bear_cli,e.battle_id=t.data.battle_id,e.current_index=t.data.current_index,e.score=t.data.score,e.current_state="up"}),this.choice_info_collection=new eui.ArrayCollection(e),this.choice_list.dataProvider=this.choice_info_collection,this.choice_list.itemRenderer=o},e}(eui.ItemRenderer);__reflect(r.prototype,"Question");var o=function(t){function e(){var e=t.call(this)||this;return e.skinName="skins.QuestionButtonSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){this.bear_cli||(this.bear_cli=this.data.bear_cli),this.choiceButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.answerQuestion,this),this.choiceButton.pixelHitTest=!1,this.choiceButton.touchEnabled=!0,"right"==this.data.current_state?this.currentState="right":"wrong"==this.data.current_state?this.currentState="wrong":"up"==this.data.current_state&&(this.currentState="up")},e.prototype.answerQuestion=function(t){console.log("you choose:",this.data.key);var e={result:this.data.isCorrect,id:this.data._id,addedScore:this.data.score,current_index:this.data.current_index,battle_id:this.data.battle_id};this.data.selected=!0,this.bear_cli.request("question.question_handler.sendAnswer",e)},e}(eui.ItemRenderer);__reflect(o.prototype,"Choice")}(Question||(Question={}));var Tip;!function(t){var e=function(t){function e(e,n,i){var r=t.call(this)||this;return r.info=n,r.addEventListener(eui.UIEvent.COMPLETE,r.uiCompHandler,r),r.bear_cli=e,r.mainScene=i,r.skinName="skins.TipSkin",r}return __extends(e,t),e.prototype.uiCompHandler=function(){console.log("add player info...");var t=[],e=this.info;e.bear_cli=this.bear_cli,t.push(e),this.tip_info_collection=new eui.ArrayCollection(t),this.tipInfo.dataProvider=this.tip_info_collection,this.tipInfo.itemRenderer=n},e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e}(eui.Component);t.TipPad=e,__reflect(e.prototype,"Tip.TipPad");var n=function(t){function e(){var e=t.call(this)||this;return e.skinName="skins.infoSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){this.bear_cli||(this.bear_cli=this.data.bear_cli)},e}(eui.ItemRenderer);__reflect(n.prototype,"Info")}(Tip||(Tip={}));